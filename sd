import pandas as pd
import json
import os

def read_intermediate_output(dag_id, name, suffix="parquet", as_pandas=True):
    """
    Generic function to read intermediate output files from notebooks.

    Args:
        dag_id (str): Parent directory or DAG name where the data is stored.
        name (str): Name of the intermediate file (without extension).
        suffix (str): File format - 'parquet' or 'json'.
        as_pandas (bool): Whether to return as a pandas DataFrame (for parquet).

    Returns:
        pd.DataFrame or dict: Data read from file.
    """
    file_path = f"./notebooks/{dag_id}/{name}.{suffix}"

    if suffix == "parquet":
        return pd.read_parquet(file_path) if as_pandas else file_path

    elif suffix == "json":
        with open(file_path, "r") as f:
            return json.load(f)

    else:
        raise ValueError(f"Unsupported file suffix: {suffix}")

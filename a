import matplotlib.pyplot as plt
import seaborn as sns

sns.histplot(y_pred, bins=2, kde=False)
plt.title("Prediction Distribution")
plt.xlabel("Predicted Class")
plt.ylabel("Frequency")
plt.grid(True)
plt.show()


if hasattr(model, "predict_proba"):
    y_proba = model.predict_proba(X_synthetic)[:, 1]
    sns.histplot(y_proba, bins=20, kde=True)
    plt.title("Prediction Probability Distribution")
    plt.xlabel("Predicted Probability")
    plt.ylabel("Count")
    plt.grid(True)
    plt.show()


import shap

shap.initjs()
explainer = shap.Explainer(model.predict, X_synthetic)
shap_values = explainer(X_synthetic[:100])  # Use subset for speed
shap.plots.beeswarm(shap_values)
